import pprint
from mpi4py import MPI
from neuroh5.io import read_tree_selection

comm = MPI.COMM_WORLD

pop_name = "GC"
gid_list = [567808, 244742, 310790, 626696, 169481, 772102, 232463, 415247, 104981, 555029, 947738, 903200, 826403, 445483, 505903, 422962, 26164, 59960, 654912, 389185, 407617, 683588, 964166, 711751, 384072, 950858, 574030, 440401, 632917, 124502, 836697, 718940, 350814, 34911, 726112, 340577, 652898, 420453, 457829, 594534, 368233, 710250, 660603, 644219, 806014, 111746, 52869, 388741, 664198, 930957, 40082, 255635, 291482, 987803, 848029, 947357, 179360, 597153, 846500, 729765, 617128, 100013, 537779, 293044, 339637, 433333, 442038, 680639, 216256, 380608, 84674, 457922, 109253, 205514, 532172, 872655, 290012, 884962, 3818, 440558, 686327, 739063, 281337, 43257, 725242, 896248, 93437, 703239, 130824, 260361, 262921, 122123, 164107, 397579, 824583, 885002, 253200, 323867, 561947, 723739, 304416, 733473, 214308, 373543, 81192, 742697, 810, 686892, 275760, 625973, 240950, 853815, 349498, 417087, 92483, 10052, 129859, 319813, 370501, 817480, 553802, 668492, 512847, 738131, 72537, 126298, 760157, 219486, 958305, 815971, 317284, 129381, 92010, 172395, 261994, 568684, 479599, 297840, 258929, 989559, 83323, 968068, 706447, 594321, 362902, 624024, 843161, 868764, 145822, 608160, 676773, 52141, 433070, 110513, 26039, 734137, 297408, 446914, 814019, 203204, 31685, 237509, 297928, 443848, 438735, 269779, 690142, 632288, 231393, 485348, 37863, 208872, 176107, 539117, 881646, 42997, 247798, 561655, 960501, 925692]

my_gid_list = []
for i, gid in enumerate(gid_list):
    if i % comm.size == comm.rank:
        my_gid_list.append(gid)

data_file_path = "/scratch1/03320/iraikov/dentate/Slice/dentatenet_Full_Scale_GC_Exc_Sat_SLN_extent_arena_margin_20201001_compressed.h5"
tree_attr_iter, _ = read_tree_selection(data_file_path, pop_name, my_gid_list, topology=True)

for (gid,t) in tree_attr_iter:
    print(gid)
    pprint.pprint(t)

